# 요기요 입점 여부 사업자번호 조회 매크로

구글 스프레드시트에 저장된 사업자번호를 요기요 입점 신청 페이지에 자동으로 조회하여, 입점 가능 여부를 판별하고 결과를 자동으로 기록하는 터미널 기반 크롤링 매크로

## 📋 주요 기능

- ✅ 요기요 사장님 사이트에서 사업자번호 입점 여부 자동 조회
- ✅ Google Sheets E열 사업자번호 자동 읽기, W열에 결과 자동 기록
- ✅ 3가지 상태 자동 분류 (입점 가능 / 이미 입점 / 번호 오류)
- ✅ 터미널 기반 CLI 인터페이스 (시작/종료 행 지정 가능)
- ✅ 실시간 진행 상황 로그 및 통계 요약
- ✅ 안정적인 에러 핸들링 (재시도, 스킵, 백업 셀렉터)

## 🚀 빠른 시작

### 1. 환경 설정

```bash
# 가상환경 생성 (권장)
python -m venv venv

# 가상환경 활성화
# Windows:
venv\Scripts\activate
# Mac/Linux:
source venv/bin/activate

# 패키지 설치
pip install -r requirements.txt
```

### 2. 환경변수 설정

`.env.example` 파일을 `.env`로 복사하고 수정:

```bash
cp .env.example .env
```

`.env` 파일 내용:
```bash
GOOGLE_SHEET_ID=<Your_Sheet_ID>
# ... 기타 설정
```

### 3. Google Sheets 공유 설정

⚠️ **중요**: 스프레드시트를 "링크가 있는 모든 사용자 - 편집자"로 공유하세요!

1. 스프레드시트 우측 상단 "공유" 버튼 클릭
2. "일반 액세스" → "링크가 있는 모든 사용자" 선택
3. 권한: "편집자" 선택
4. "완료" 클릭

### 4. 실행

```bash
# PoC 테스트 (단일 사업자번호)
python yogiyo_checker.py

# 전체 매크로 실행 (개발 예정)
python main.py
```

## 📊 스프레드시트 구조

```
┌──┬───┬───┬─────────┬───┬──────────┬───┬──────────────┐
│A │ B │ C │    D    │ E │    F     │ G │      H       │
├──┼───┼───┼─────────┼───┼──────────┼───┼──────────────┤
│번호│...│...│  ...    │사업자번호│    ...   │...│    ...       │
└──┴───┴───┴─────────┴───┴──────────┴───┴──────────────┘
                        ↑                      ↑
                        E열                    W열
                     (입력)                  (출력)
```

- **E열**: 조회할 사업자번호 (10자리 숫자)
- **W열**: 조회 결과 메시지 (자동 기록)
- **1~2행**: 헤더 (자동 건너뜀)
- **3행부터**: 실제 데이터

## 🎯 조회 결과 분류

| 상태 | 메시지 | 의미 |
|------|--------|------|
| `AVAILABLE` | "입점신청 가능한 사업자번호입니다" | ✅ 입점 가능 (목표 대상) |
| `REGISTERED` | "이미 등록된 사업자번호입니다..." | ❌ 이미 입점함 |
| `INVALID` | "사업자 번호를 확인해 주세요." | ⚠️ 번호 형식 오류 |

## 🔧 개발 상태

### ✅ 완료
- [x] M1: PRD 작성 및 개발 환경 설정
- [x] 프로젝트 구조 생성 (config, requirements, .gitignore)
- [x] 기본 크롤링 로직 (YogiyoChecker 클래스)
- [x] 셀렉터 백업 전략 (우선순위 1~3)
- [x] 메시지 분류 로직

### 🔄 진행 중
- [ ] M2: 기본 크롤링 PoC 테스트 및 검증
- [ ] M3: Google Sheets 연동 (google_sheets_client.py)
- [ ] M4: main.py CLI 인터페이스
- [ ] M5: 에러 핸들링 및 로그 시스템
- [ ] M6: 대량 데이터 테스트

### 📅 예정
- [ ] GUI 버전 개발 (tkinter)
- [ ] 배달의민족 통합 조회
- [ ] 자동 태깅 및 리포트 생성

## ⚙️ 설정 커스터마이징

`config.py` 또는 `.env` 파일에서 다음 설정 변경 가능:

```python
# 대기 시간 조정
PAGE_LOAD_WAIT = 5      # 페이지 로드 대기 (초)
BUTTON_CLICK_WAIT = 3   # 버튼 클릭 후 대기 (초)
SEARCH_DELAY = 1.0      # 조회 간 딜레이 (초)

# 스프레드시트 열 위치
COLUMN_BUSINESS_NUMBER = 'E'  # 사업자번호 입력 열
COLUMN_RESULT = 'W'           # 결과 출력 열

# 기타 옵션
SKIP_EXISTING = false    # 이미 결과가 있는 행 스킵 여부
HEADLESS_MODE = false    # 브라우저 숨김 모드
```

## 📝 사용 예시

```bash
$ python main.py

================================================================================
요기요 입점 여부 사업자번호 조회 매크로 v1.0
================================================================================

조회할 Google 스프레드시트 ID를 입력하세요:
> 1A2B3C4D5E6F7G8H9I0J

시작 행 (기본값 3):
> 3

종료 행 (0=끝까지):
> 0

[INFO] Google Sheets API 연결 중...
[OK] Google Sheets API 연결 완료
[INFO] E열 데이터 읽기 중...
[OK] 100개 사업자번호 읽기 완료

[3/100] Row 3: 1234567890
  → 입력 완료
  → 조회 버튼 클릭
  → 결과: "입점신청 가능한 사업자번호입니다"
  → W3 저장 완료
  ✓ [SUCCESS] Row 3 processed (3.2초 소요)

...

================================================================================
처리 완료!
================================================================================
총 처리 행: 100
  - 성공: 95
  - 실패: 3
  - 스킵: 2

상태별 집계:
  - 입점 가능 (AVAILABLE): 60
  - 이미 입점 (REGISTERED): 30
  - 번호 오류 (INVALID): 5

총 소요 시간: 5분 15초
평균 처리 시간: 3.15초/건
================================================================================
```

## ⚠️ 주의사항

### 법적 고려사항
- ⚠️ robots.txt 확인 필수
- ⚠️ 이용약관 위반 여부 확인
- ⚠️ 개인정보 수집 주의
- ⚠️ 상업적 이용 시 법적 검토 권장

### 기술적 제약
- ⚠️ 요기요 사이트 구조 변경 시 셀렉터 업데이트 필요
- ⚠️ 차단 방지를 위한 딜레이 필수 (최소 0.5초)
- ⚠️ Chrome 브라우저 설치 필요
- ⚠️ 안정적인 인터넷 연결 필요

## 📚 참고 문서

- [PRD 문서](./PRD_요기요입점여부조회매크로.md)
- [네이버 크롤링 참고 분석](./참고자료_네이버크롤링분석.txt)
- [Selenium 공식 문서](https://selenium-python.readthedocs.io/)
- [Google Sheets API 가이드](https://developers.google.com/sheets/api/guides/concepts)

## 📄 라이선스

본 매크로는 내부 운영 및 업무 효율화 목적으로 개발되었습니다.
상업적 이용 시 법률 전문가의 검토를 권장합니다.

## 🤝 기여

이슈 및 개선 제안은 GitHub Issues를 통해 제출해주세요.

---

**문서 버전**: v1.0
**최종 수정일**: 2025-01-16
**작성자**: bjcho9542-hash
